(()=>{"use strict";const e=window.wp.interactivity;function t(e){n.index=e,n.src=n.images[e]}const{state:n,actions:o}=(0,e.store)("fs/lightbox",{state:{src:null,phase:"closed",opener:null,images:[],index:0},actions:{open({images:e,index:t=0,opener:o}){n.opener=o,function(e=[],t=0){n.images=e,n.index=t,n.src=e[t]||null}(e,t),n.phase="open",window.requestAnimationFrame((()=>{n.phase="opened",document.querySelector(".fs-lightbox-close")?.focus()}))},close(){n.phase="close",window.setTimeout((()=>{n.phase="closed",n.src=null,n.images=[],n.index=0,n.opener&&(n.opener.focus(),n.opener=null)}),300)},next(){0!==n.images.length&&t((n.index+1)%n.images.length)},prev(){0!==n.images.length&&t((n.index-1+n.images.length)%n.images.length)}},callbacks:{open(e){const t=e?.currentTarget,n=t.closest(".wp-block-gallery");let r=[],s=0;if(n){const e=n.querySelectorAll("img.fs-lightbox-img");r=Array.from(e).map((e=>e.currentSrc||e.src)),s=Array.from(e).indexOf(t)}else r=[t?.currentSrc||t?.src];o.open({images:r,index:s,opener:t})}},effects:{handleEscape(){if("closed"===n.phase)return;const e=e=>{"Escape"===e.key?o.close():"ArrowRight"===e.key?o.next():"ArrowLeft"===e.key&&o.prev()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},manageBodyScroll(){"open"===n.phase||"opened"===n.phase?document.body.classList.add("fs-lightbox-open"):document.body.classList.remove("fs-lightbox-open")},trapFocus(){if("closed"===n.phase)return;const e=document.querySelector(".fs-lightbox-dialog"),t=e.querySelectorAll('a[href], button:not([disabled]), textarea, input, select, [tabindex]:not([tabindex="-1"])'),o=t[0],r=t[t.length-1],s=n=>{if("Tab"!==n.key)return;if(0===t.length)return void n.preventDefault();const s=e.ownerDocument.activeElement;n.shiftKey?s===o&&(n.preventDefault(),r.focus()):s===r&&(n.preventDefault(),o.focus())};return e.addEventListener("keydown",s),()=>e.removeEventListener("keydown",s)}}}),r=()=>{!function(){const e=document.querySelectorAll("video[data-fs-lazy-video][data-src]");if(0!==e.length)if("IntersectionObserver"in window){const t={root:null,rootMargin:"200px",threshold:0},n=new window.IntersectionObserver((e=>{e.forEach((e=>{if(e.isIntersecting){const t=e.target,o=t.getAttribute("data-src");o&&(t.setAttribute("src",o),t.removeAttribute("data-src")),n.unobserve(t)}}))}),t);e.forEach((e=>n.observe(e)))}else e.forEach((e=>{const t=e.getAttribute("data-src");t&&(e.setAttribute("src",t),e.removeAttribute("data-src"))}))}(),function(){const e=document.querySelectorAll(".fs-video-overlay button");e.length&&e.forEach((e=>{e.addEventListener("click",(()=>{const t=e.closest(".fs-video-overlay");if(!t)return;const n=t.nextElementSibling;n&&"VIDEO"===n.tagName&&(t.remove(),n.play())}))}))}()};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",r):r()})();
